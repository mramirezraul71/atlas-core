# ATLAS Cognitive OS - config (copy to atlas.env)
# Policy + Audit + timeouts obligatorios. Modo seguro por defecto.

# --- Memory (persistente SQLite) ---
MEMORY_ENABLED=true
MEMORY_DB_PATH=C:\ATLAS_PUSH\logs\atlas_memory.sqlite
ATLAS_MEMORY_DB_PATH=C:\ATLAS_PUSH\logs\atlas_memory.sqlite
MEMORY_FTS_ENABLED=true
MEMORY_EMBEDDINGS_ENABLED=false

# --- Vision / Web / Voice ---
VISION_ENABLED=true
WEB_ENABLED=true
VOICE_ENABLED=true

# --- Scheduler (SQLite, lease, backoff) ---
SCHED_ENABLED=true
SCHED_DB_PATH=C:\ATLAS_PUSH\logs\atlas_sched.sqlite
SCHED_TICK_SECONDS=2
SCHED_MAX_CONCURRENCY=1
SCHED_LEASE_SECONDS=30
SCHED_STALE_RECOVERY=true

# --- Release train (stable/canary) ---
RELEASE_ENABLED=true
RELEASE_CHANNEL=canary
RELEASE_REQUIRE_TAG=true
RELEASE_TAG_PREFIX=v
RELEASE_UPDATE_STRATEGY=bluegreen_local
RELEASE_POST_PROMOTE_CI=true

# --- Update (git staging + smoke + promote/rollback) ---
UPDATE_ENABLED=true
UPDATE_REMOTE=origin
UPDATE_BRANCH=main
UPDATE_STAGING_BRANCH=staging
UPDATE_REQUIRE_SMOKE=true
UPDATE_ALLOW_ROLLBACK=true
UPDATE_APPLY=false
POLICY_ALLOW_UPDATE_APPLY=false

# --- Watchdog + Self-Healing ---
WATCHDOG_ENABLED=true
HEALING_ENABLED=true

# --- LLM (timeout obligatorio) ---
OLLAMA_BASE_URL=http://127.0.0.1:11434
LLM_TIMEOUT_SEC=60
OLLAMA_MODEL_FAST=llama3.2:3b

# --- Policy / Audit ---
POLICY_DEFAULT_ROLE=owner
POLICY_MODE=strict
POLICY_ALLOWED_PATHS=C:\ATLAS_PUSH
AUDIT_DB_PATH=C:\ATLAS_PUSH\logs\atlas_audit.sqlite

# --- Continuous Improvement ---
CI_ENABLED=true
CI_DEFAULT_MODE=plan_only
CI_MAX_ITEMS=10
CI_EXPORT_DIR=C:\ATLAS_PUSH\snapshots\ci
CI_ALLOWED_AUTOFIX=true
CI_AUTOFIX_LIMIT=2
CI_GIT_COMMIT_AUTOFIX=false

# --- Blue-Green Local Deployment ---
DEPLOY_MODE=single
ACTIVE_PORT=8791
STAGING_PORT=8792
AUTO_SWITCH_ON_HEALTH=true
DEPLOY_HEALTH_MIN_SCORE=75
DEPLOY_HEALTH_RETRIES=3
DEPLOY_HEALTH_RETRY_SECONDS=2

# --- Canary Ramp-Up ---
CANARY_ENABLED=false
CANARY_PERCENTAGE=0.2
CANARY_ERROR_RATE_THRESHOLD=0.25
CANARY_LATENCY_THRESHOLD_MS=4000
CANARY_FEATURES=vision,web,optimizer

# --- Windows Service (optional) ---
SERVICE_ENABLED=false
SERVICE_NAME=ATLAS_PUSH
SERVICE_PORT=8791
SERVICE_BIND=127.0.0.1
SERVICE_LOG_PATH=C:\ATLAS_PUSH\logs\service.log

# --- Stealth Gateway (multi-path: Cloudflare / Tailscale / SSH / LAN) ---
GATEWAY_ENABLED=false
GATEWAY_MODE=auto
GATEWAY_EXPECTED_WORKERS=1
CLOUDFLARE_TUNNEL_ENABLED=false
CLOUDFLARE_CLOUDFLARED_PATH=C:\ATLAS_PUSH\bin\cloudflared.exe
CLOUDFLARE_TUNNEL_NAME=atlas-worker-1
CLOUDFLARE_TUNNEL_URL=
CLOUDFLARE_TOKEN=
TAILSCALE_ENABLED=false
TAILSCALE_EXE_PATH=C:\Program Files\Tailscale\tailscale.exe
TAILSCALE_EXPECTED_NODE=atlas-worker-1
TAILSCALE_DNS_NAME=atlas-worker-1
SSH_TUNNEL_ENABLED=false
SSH_EXE_PATH=C:\Windows\System32\OpenSSH\ssh.exe
SSH_USER=atlas
SSH_HOST=
SSH_REMOTE_PORT=18791
SSH_LOCAL_PORT=8791
LAN_ENABLED=false
LAN_WORKER_URL=http://192.168.1.50:8791
GATEWAY_BOOTSTRAP_RETRY_SECONDS=5
GATEWAY_BOOTSTRAP_MAX_RETRIES=10
GATEWAY_HEALTH_MIN_SCORE=75

# --- Atlas Cluster (multi-node) ---
CLUSTER_ENABLED=false
CLUSTER_NODE_ID=HQ-1
CLUSTER_ROLE=hq
CLUSTER_REGISTRY_DB=C:\ATLAS_PUSH\logs\atlas_cluster.sqlite
CLUSTER_SHARED_SECRET=CHANGE_ME_LONG_RANDOM
CLUSTER_TOKEN_TTL_SECONDS=3600
CLUSTER_HEARTBEAT_SECONDS=5
CLUSTER_NODE_OFFLINE_SECONDS=20
CLUSTER_DEFAULT_ROUTE=local
CLUSTER_BOOTSTRAP_NODES=

# --- Owner Control Layer (Zero-Trust) ---
OWNER_ENABLED=true
OWNER_ID=raul
OWNER_STRICT_MODE=true
OWNER_SESSION_TTL_SECONDS=900
OWNER_REQUIRE_SESSION_FOR_RISK=medium
OWNER_2FA_REQUIRED_FOR=critical
OWNER_APPROVAL_DEFAULT_TTL_SECONDS=900
OWNER_SESSION_TIMEOUT=900

APPROVALS_CHAIN_ENABLED=true
APPROVALS_CHAIN_SECRET=CHANGE_ME_LONG_RANDOM
APPROVALS_REPLAY_TTL_SECONDS=3600
APPROVAL_EXPIRE_MINUTES=15

EMERGENCY_MODE=false
EMERGENCY_BLOCK_DEPLOY=true
EMERGENCY_BLOCK_REMOTE_EXEC=true
EMERGENCY_BLOCK_SHELL=true
EMERGENCY_ALLOW_STATUS=true

TELEGRAM_APPROVALS_ENABLED=true
TELEGRAM_ALLOWED_CHAT_IDS=
TELEGRAM_REQUIRE_CONFIRM=true
OWNER_TELEGRAM_CONFIRM=true

VOICE_APPROVALS_ENABLED=true
VOICE_REQUIRE_CONFIRM=true
OWNER_VOICE_CONFIRM=true

# --- Governed Autonomy ---
GOVERNED_AUTONOMY_ENABLED=true
GA_MODE=plan_only
GA_SAFE_AUTORUN_ENABLED=true
GA_SAFE_AUTORUN_LIMIT=2
GA_APPROVAL_REQUIRED_FOR=medium
GA_CYCLE_INTERVAL_MINUTES=60
GA_MAX_FINDINGS=10
GA_REPORT_DIR=C:\ATLAS_PUSH\snapshots\ga
GA_STRICT_EVIDENCE=true
GA_POST_UPDATE_AUTOCHECK=true
GA_POST_DEPLOY_HEALTH_MIN=75

# --- Meta-Learning ---
METALEARN_ENABLED=true
METALEARN_DB_PATH=C:\ATLAS_PUSH\logs\atlas_metalearn.sqlite
METALEARN_MODE=stats
METALEARN_MIN_SAMPLES=10
METALEARN_DECAY=0.98
METALEARN_UPDATE_INTERVAL_MINUTES=60
METALEARN_MAX_RULES=100
METALEARN_ALLOW_AUTOTUNE=true
METALEARN_RISK_SHIFT_MAX=0.15
METALEARN_CANARY_PERCENTAGE_MAX=0.5
METALEARN_AUTORUN_LIMIT_MAX=5

# --- Product (Atlas Product Pack) ---
PRODUCT_MODE=false
PRODUCT_EDITION=community
PRODUCT_VERSION_FROM_TAG=true
PRODUCT_LICENSE_REQUIRED=false
SUPPORT_BUNDLE_AUTO=false
SUPPORT_UPLOAD_ENABLED=false
SUPPORT_CONTACT=

# --- Humanoid ---
HUMANOID_ENABLED=true
